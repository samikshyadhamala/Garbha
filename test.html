<!DOCTYPE html>
<html>
<head>
  <title>Chat Test</title>
  <style>
    body { font-family: Arial; margin: 50px; }
    input, textarea, button { margin: 10px 0; padding: 10px; width: 100%; max-width: 500px; }
    button { background: #4CAF50; color: white; border: none; cursor: pointer; }
    #result { background: #f0f0f0; padding: 15px; margin-top: 20px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>ü§ñ Test Chat API</h1>
  
  <label>JWT Token:</label>
  <input type="text" id="token" placeholder="Paste your JWT token here" />
  
  <label>Message:</label>
  <textarea id="message" rows="4" placeholder="Type your message...">Hello! I need advice about pregnancy.</textarea>
  
  <label>Upload File (optional):</label>
  <input type="file" id="file" accept=".pdf,.txt,.jpg,.png" />
  
  <button onclick="sendMessage()">Send Message</button>
  
  <div id="result"></div>
  
  <script>
    async function sendMessage() {
      const token = document.getElementById('token').value;
      const message = document.getElementById('message').value;
      const file = document.getElementById('file').files[0];
      const resultDiv = document.getElementById('result');
      
      if (!token) {
        resultDiv.textContent = '‚ùå Please enter your JWT token';
        return;
      }
      
      resultDiv.textContent = '‚è≥ Sending...';
      
      const formData = new FormData();
      formData.append('message', message);
      if (file) {
        formData.append('files', file);
      }
      
      try {
        const response = await fetch('http://localhost:3000/api/chat/message', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${token}`
          },
          body: formData
        });
        
        const data = await response.json();
        
        if (data.success) {
          resultDiv.textContent = `‚úÖ SUCCESS!\n\nAI Response:\n${data.message}\n\nProcessed Attachments: ${data.processedAttachments}`;
        } else {
          resultDiv.textContent = `‚ùå Error: ${JSON.stringify(data, null, 2)}`;
        }
      } catch (error) {
        resultDiv.textContent = `‚ùå Error: ${error.message}`;
      }
    }
  </script>
</body>
</html>